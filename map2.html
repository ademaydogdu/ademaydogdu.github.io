<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>LED Map Generator</title>

<style>
    body {
        background: #0f172a;
        color: white;
        font-family: Arial;
        padding: 20px;
    }

    h2 {
        margin-top: 30px;
    }

    button {
        padding: 6px 14px;
        margin: 5px;
        border: none;
        background: #475569;
        color: white;
        border-radius: 6px;
        cursor: pointer;
    }

    .block, .inner-block {
        background: rgba(255,255,255,0.05);
        padding: 15px;
        margin-top: 15px;
        border-radius: 10px;
    }

    .row-group {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-bottom: 10px;
    }

    .row-group input[type=number] {
        width: 100px;
    }

    label {
        font-size: 14px;
    }

    .checkbox-label {
        display: flex;
        align-items: center;
        gap: 5px;
    }

    #output {
        margin-top: 20px;
        white-space: pre;
        padding: 15px;
        background: #1e293b;
        border-radius: 8px;
        color: #e2e8f0;
    }

    #totalsBox {
        margin-top: 15px;
        padding: 10px;
        background: rgba(255,255,255,0.10);
        border-radius: 8px;
        font-size: 14px;
        line-height: 1.5;
        width: fit-content;
    }
</style>
</head>
<body>

<h2>1) Dış LED Blokları</h2>
<button onclick="addOuter()">Dış Blok Ekle</button>

<div id="outerBlocks"></div>

<hr>

<h2>2) İç LED Blokları (1–3 sıra)</h2>
<button onclick="addInner()">İç Blok Ekle</button>

<div id="innerBlocks"></div>

<hr>

<button onclick="generateMap()">LED MAP OLUŞTUR</button>

<div id="totalsBox"></div>

<button onclick="copyJSON()" style="margin-top:10px;">JSON'u Kopyala</button>
    
<pre id="output"></pre>
    


<script>

// ===========================
// Dış Blok Ekle
// ===========================
function addOuter() {
    const outer = document.createElement("div");
    outer.classList.add("block");
    outer.innerHTML = `
        <div class="row-group">
            <label>Başlangıç</label>
            <input type="number" class="start">

            <label>Bitiş</label>
            <input type="number" class="end">

            <label class="checkbox-label">
                <input type="checkbox" class="reverse">
                ters
            </label>

            <button class="remove">Sil</button>
        </div>
    `;
    outer.querySelector(".remove").onclick = () => outer.remove();
    document.getElementById("outerBlocks").appendChild(outer);
}

// ===========================
// İç Blok Ekle (1–3 sıra)
// ===========================
function addInner() {
    const block = document.createElement("div");
    block.classList.add("inner-block");

    block.innerHTML = `
        <!-- Row 1 -->
        <div class="row-group">
            <label>İç 1. sıra başlangıç</label>
            <input type="number" class="row1-start">
            <label>İç 1. sıra bitiş</label>
            <input type="number" class="row1-end">

            <label class="checkbox-label">
                <input type="checkbox" class="row1-reverse">
                ters
            </label>
        </div>

        <!-- Row 2 -->
        <div class="row-group">
            <label>İç 2. sıra başlangıç</label>
            <input type="number" class="row2-start">
            <label>İç 2. sıra bitiş</label>
            <input type="number" class="row2-end">

            <label class="checkbox-label">
                <input type="checkbox" class="row2-reverse">
                ters
            </label>
        </div>

        <!-- Row 3 -->
        <div class="row-group">
            <label>İç 3. sıra başlangıç</label>
            <input type="number" class="row3-start">
            <label>İç 3. sıra bitiş</label>
            <input type="number" class="row3-end">

            <label class="checkbox-label">
                <input type="checkbox" class="row3-reverse">
                ters
            </label>
        </div>

        <button class="remove-inner">Sil</button>
    `;

    block.querySelector(".remove-inner").onclick = () => block.remove();
    document.getElementById("innerBlocks").appendChild(block);
}

// ===========================================
// Güvenli Aralık Okuma + Ters İşleme
// ===========================================
function safeRange(startInput, endInput, reverseInput) {
    const sVal = startInput.value.trim();
    const eVal = endInput.value.trim();

    // Başlangıç veya bitiş boşsa: hiç LED ekleme
    if (sVal === "" || eVal === "") return [];

    const s = Number(sVal);
    const e = Number(eVal);

    if (isNaN(s) || isNaN(e)) return [];

    let arr = [];

    if (s <= e) {
        for (let i = s; i <= e; i++) arr.push(i);
    } else {
        for (let i = s; i >= e; i--) arr.push(i);
    }

    if (reverseInput.checked) arr.reverse();

    return arr;
}


// ===========================================
// MAP OLUŞTUR — DIŞ SONRA İÇ
// ===========================================
function generateMap() {
    let final = [];

    let outerTotal = 0;
    let innerTotal = 0;

    // ---- Dış bloklar ----
    document.querySelectorAll("#outerBlocks .block").forEach(block => {
        const range = safeRange(
            block.querySelector(".start"),
            block.querySelector(".end"),
            block.querySelector(".reverse")
        );
        outerTotal += range.length;
        final.push(...range);
    });

    // ---- İç bloklar ----
    document.querySelectorAll("#innerBlocks .inner-block").forEach(block => {

        const row1 = safeRange(block.querySelector(".row1-start"), block.querySelector(".row1-end"), block.querySelector(".row1-reverse"));
        const row2 = safeRange(block.querySelector(".row2-start"), block.querySelector(".row2-end"), block.querySelector(".row2-reverse"));
        const row3 = safeRange(block.querySelector(".row3-start"), block.querySelector(".row3-end"), block.querySelector(".row3-reverse"));

        const max = Math.max(row1.length, row2.length, row3.length);
        let woven = [];

        for (let i = 0; i < max; i++) {
            if (row1[i] !== undefined) woven.push(row1[i]);
            if (row2[i] !== undefined) woven.push(row2[i]);
            if (row3[i] !== undefined) woven.push(row3[i]);
        }

        innerTotal += woven.length;
        final.push(...woven);
    });

    // === TOPLAM KUTUSU ===
    document.getElementById("totalsBox").innerHTML = `
        <b>Toplam Dış LED:</b> ${outerTotal}<br>
        <b>Toplam İç LED:</b> ${innerTotal}<br>
        <b>Genel Toplam:</b> ${outerTotal + innerTotal}
    `;

    // Sonucu göster
    document.getElementById("output").textContent =
        JSON.stringify(final, null, 2);
}
function copyJSON() {
    const text = document.getElementById("output").textContent.trim();

    if (!text) {
        alert("Kopyalanacak JSON bulunamadı!");
        return;
    }

    navigator.clipboard.writeText(text)
        .then(() => alert("JSON kopyalandı!"))
        .catch(() => alert("Kopyalama başarısız!"));
}


    
</script>

</body>
</html>
